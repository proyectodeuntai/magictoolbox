<!DOCTYPE html>
<html lang="es" class="scroll-smooth">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Magic Card Matcher</title>
    <link rel="icon" href="../../assets/calvo.webp" type="image/png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css" />
    <style>
        .user-header:hover {
            background-color: rgba(0, 0, 0, 0.02);
        }

        .dark .user-header:hover {
            background-color: rgba(255, 255, 255, 0.02);
        }

        #wishlistProgressBarContainer {
            background-color: #e5e7eb;
            border-radius: 9999px;
            height: 0.5rem;
            overflow: hidden;
        }

        #wishlistProgressBar {
            transition: width 0.5s ease-in-out;
            background-color: #10b981;
            height: 100%;
        }

        /* Mejorar estilo del label de archivo */
        .file-label {
            display: block;
            width: 100%;
            text-align: center;
            border: 2px dashed #d1d5db;
            padding: 0.75rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.15s;
            background-color: transparent;
        }

        .file-label:hover {
            background-color: rgba(0, 0, 0, 0.05);
            border-color: #9ca3af;
        }

        .dark .file-label {
            border-color: #4b5563;
        }

        .dark .file-label:hover {
            background-color: rgba(255, 255, 255, 0.05);
            border-color: #6b7280;
        }
    </style>
</head>

<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen">
    <header class="w-full text-center py-4 bg-gray-50 dark:bg-gray-900 border-b dark:border-gray-700 shadow-md">
        <a href="../../index.html"
            class="text-3xl font-extrabold text-indigo-600 dark:text-indigo-400 hover:text-indigo-700 dark:hover:text-indigo-300 transition-colors duration-300 no-underline cursor-pointer">
            üé¥ Magic Card Matcher
        </a>
    </header>

    <main class="p-6 max-w-7xl mx-auto space-y-6">
        <div class="grid lg:grid-cols-3 gap-6">
            <section class="lg:col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 h-fit">
                <h2 class="text-xl font-semibold mb-4">üìö Mi Colecci√≥n (DB)</h2>

                <div class="space-y-4">
                    <div>
                        <label for="identifier" class="block text-sm font-medium mb-1">Tu identificador /
                            Nombre:</label>
                        <input type="text" id="identifier" placeholder="Ej: Calvo"
                            class="w-full border rounded px-3 py-2 dark:bg-gray-700 dark:border-gray-600">
                    </div>

                    <label id="myFile" for="uploadFile" class="file-label">
                        Seleccionar archivo (.csv)
                    </label>
                    <input type="file" id="uploadFile" accept=".csv, text/plain">
                    <button id="saveBtn"
                        class="w-full bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 font-semibold transition duration-150">
                        üíæ Guardar Lista
                    </button>
                    <div id="message" class="text-sm mt-2"></div>
                </div>

                <hr class="my-6 border-gray-200 dark:border-gray-700">

                <h3 class="text-lg font-semibold mb-3">Jugadores Cargados:</h3>
                <div id="userListsDiv" class="space-y-2">
                    <p class="text-gray-500 dark:text-gray-400 text-sm">Carga una lista para empezar.</p>
                </div>

                <hr class="my-6 border-gray-200 dark:border-gray-700">

                <div class="flex gap-2">
                    <button id="exportBtn"
                        class="flex-1 bg-yellow-600 text-white px-4 py-2 rounded hover:bg-yellow-700 font-semibold text-sm transition duration-150">
                        Exportar DB
                    </button>
                    <input type="file" id="importFile" accept=".json" class="hidden">
                    <label id="myList" for="importFile"
                        class="flex-1 text-center bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 font-semibold text-sm cursor-pointer transition duration-150">
                        Importar DB
                    </label>
                </div>
            </section>

            <section class="lg:col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 h-fit">
                <h2 class="text-xl font-semibold mb-4">‚≠ê Mi Wishlist</h2>

                <details class="mb-4 p-3 rounded-lg bg-gray-50 dark:bg-gray-700/50 shadow-inner">
                    <summary class="font-medium cursor-pointer text-sm">
                        Estad√≠sticas de Wishlist
                    </summary>
                    <div class="mt-2 text-sm space-y-1">
                        <div id="wishlistStats">
                            <p>Total de cartas: <span id="wishlistTotal" class="font-bold">0</span></p>
                            <p>Disponibles: <span id="wishlistAvailable" class="font-bold text-emerald-600">0</span>
                            </p>
                            <p>Faltantes: <span id="wishlistMissing" class="font-bold text-red-600">0</span></p>
                            <p>Valor total (AVG MKM): <span id="wishlistValue" class="font-bold text-blue-600">0.00
                                    ‚Ç¨</span></p>
                        </div>
                        <div id="wishlistProgressBarContainer" class="mt-3">
                            <div id="wishlistProgressBar" style="width: 0%;"></div>
                        </div>
                        <p class="text-right text-xs mt-1"><span id="wishlistPercentage" class="font-bold">0%</span>
                            completado</p>
                    </div>
                </details>

                <div class="space-y-3 mb-6 p-4 border rounded-lg dark:border-gray-700">
                    <label for="wishlistInput" class="block text-sm font-medium">A√±adir Carta (1x Nombre
                        [SETCODE])</label>
                    <div class="flex gap-2">
                        <input type="text" id="wishlistInput" placeholder="Ej: 1x Sol Ring (3ED)"
                            class="flex-1 border rounded px-3 py-2 dark:bg-gray-700 dark:border-gray-600 text-sm">
                        <button id="addWishlistBtn"
                            class="bg-pink-600 text-white px-4 py-2 rounded hover:bg-pink-700 transition duration-150">
                            A√±adir
                        </button>
                    </div>
                    <div class="flex gap-2 text-xs text-gray-500">
                        <label class="flex items-center gap-1">
                            <input type="checkbox" id="wishlistFoilOnly" class="rounded">
                            Solo Foil
                        </label>
                        <label class="flex items-center gap-1">
                            <input type="checkbox" id="wishlistSpecificSet" class="rounded">
                            Set espec√≠fico
                        </label>
                        <input type="text" id="wishlistSetCode" placeholder="C√≥digo set (ej: MH3)"
                            class="border rounded px-2 py-1 text-xs dark:bg-gray-800 dark:border-gray-600 disabled:opacity-50"
                            disabled>
                    </div>
                </div>

                <div id="wishlistContent" class="space-y-2"></div>

                <button id="checkWishlistAvailability"
                    class="w-full mt-4 bg-indigo-600 text-white px-4 py-3 rounded hover:bg-indigo-700 font-semibold transition duration-150">
                    üîç Buscar Disponibilidad
                </button>

                <div id="wishlistResults" class="mt-4"></div>
            </section>

            <section class="lg:col-span-1 bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 h-fit">
                <h2 class="text-xl font-semibold mb-4">üîé Buscador / Match</h2>

                <div class="mb-4">
                    <label for="searchCard" class="block text-sm font-medium mb-1">Nombre de la carta:</label>
                    <div class="text-xs text-gray-500 mb-2">
                        üí° Para buscar m√∫ltiples cartas, sep√°ralas con "<strong>, </strong>" (coma + espacio)<br>
                        Ejemplo: <code
                            class="bg-gray-200 dark:bg-gray-700 px-1 rounded">Sol Ring, Lightning Bolt, Counterspell</code>
                    </div>
                    <div class="flex gap-2">
                        <input type="text" id="searchCard" placeholder="Ej: Ragavan, Nimble Pilferer"
                            class="flex-1 border rounded px-3 py-2 dark:bg-gray-700 dark:border-gray-600">
                        <button id="searchBtn"
                            class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 font-semibold transition duration-150">
                            Buscar
                        </button>
                    </div>
                </div>

                <details class="mb-6 p-3 rounded-lg bg-gray-50 dark:bg-gray-700/50 shadow-inner">
                    <summary class="font-medium cursor-pointer text-sm">
                        Filtros de B√∫squeda
                    </summary>
                    <div class="mt-2 space-y-3">
                        <div>
                            <label for="filterFoil" class="block text-sm font-medium mb-1">Foil/No-Foil:</label>
                            <select id="filterFoil"
                                class="w-full border rounded px-3 py-2 dark:bg-gray-700 dark:border-gray-600">
                                <option value="all">Cualquiera</option>
                                <option value="foil">Solo Foil</option>
                                <option value="nonfoil">Solo No-Foil</option>
                            </select>
                        </div>
                        <div>
                            <label for="filterRarity" class="block text-sm font-medium mb-1">Rareza:</label>
                            <select id="filterRarity"
                                class="w-full border rounded px-3 py-2 dark:bg-gray-700 dark:border-gray-600">
                                <option value="all">Cualquiera</option>
                                <option value="mythic">M√≠tica</option>
                                <option value="rare">Rara</option>
                                <option value="uncommon">Infrecuente</option>
                                <option value="common">Com√∫n</option>
                            </select>
                        </div>
                        <div>
                            <label for="filterSet" class="block text-sm font-medium mb-1">Set:</label>
                            <select id="filterSet"
                                class="w-full border rounded px-3 py-2 dark:bg-gray-700 dark:border-gray-600">
                                <option value="all">Cualquiera</option>
                            </select>
                        </div>
                        <div>
                            <label for="filterLanguage" class="block text-sm font-medium mb-1">Idioma:</label>
                            <select id="filterLanguage"
                                class="w-full border rounded px-3 py-2 dark:bg-gray-700 dark:border-gray-600">
                                <option value="all">Cualquiera</option>
                                <option value="es">Espa√±ol</option>
                                <option value="en">Ingl√©s</option>
                                <option value="fr">Franc√©s</option>
                                <option value="de">Alem√°n</option>
                                <option value="it">Italiano</option>
                                <option value="jp">Japon√©s</option>
                                <option value="cn">Chino</option>
                            </select>
                        </div>

                        <div class="flex justify-end gap-2 mt-4">
                            <div id="filterMessage" class="text-sm text-red-500 mr-auto flex items-center"></div>
                            <button id="clearFiltersBtn"
                                class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 font-semibold transition duration-150">
                                Limpiar Filtros
                            </button>
                            <select id="filterStatus"
                                class="border rounded px-3 py-2 dark:bg-gray-700 dark:border-gray-600">
                                <option value="all">Ver Todo</option>
                                <option value="missing">Ver Faltantes</option>
                                <option value="available">Ver Disponibles</option>
                            </select>
                        </div>
                    </div>
                </details>

                <h2 class="text-xl font-semibold mb-4">Resultado de B√∫squeda / Match</h2>
                <div class="flex justify-end mb-4">
                    <details class="relative">
                        <summary
                            class="flex items-center justify-center p-2 rounded-lg bg-gray-200 dark:bg-gray-700 cursor-pointer hover:bg-gray-300 dark:hover:bg-gray-600 transition duration-150 font-medium">
                            Acciones
                        </summary>
                        <div
                            class="absolute right-0 bottom-full mb-2 w-48 origin-top-right rounded-md shadow-2xl bg-white dark:bg-gray-800 ring-1 ring-black ring-opacity-5 focus:outline-none z-10">
                            <div class="py-1" role="menu" aria-orientation="vertical" aria-labelledby="menu-button"
                                tabindex="-1">
                                <button id="exportResults"
                                    class="w-full text-right px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700"
                                    role="menuitem" tabindex="-1">
                                    üì§ Exportar Resultados
                                </button>
                                <button id="compareUsers"
                                    class="w-full text-right px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700"
                                    role="menuitem" tabindex="-1">
                                    ‚öñÔ∏è Comparar Jugadores
                                </button>
                                <button id="statsBtn"
                                    class="w-full text-right px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700"
                                    role="menuitem" tabindex="-1">
                                    üìä Ver Estad√≠sticas
                                </button>
                            </div>
                        </div>
                    </details>
                </div>
                <div id="resultsDiv">
                </div>
            </section>
        </div>
    </main>

    <footer class="text-center p-4 text-xs text-gray-500 dark:text-gray-400">
        Magic Card Matcher - Utiliza datos de Cardmarket y Scryfall (proxy de precios MKM)
    </footer>

    <div id="mainMessage"
        class="fixed top-4 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-lg shadow-xl text-white z-50 transition-opacity duration-300 opacity-0 pointer-events-none">
    </div>

    <script src="script.js"></script>
</body>

</html>